<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android基础之Activity学习 | Daniel_Wen&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在安卓应用开发过程中，Activity是我们最常接触的。关于Activity，官方文档介绍的非常详细：Activity基础知识介绍：(http://developer.android.com/guide/components/activities.html)Activity生命周期管理：(http://developer.android.com/training/basics/activity-l">
<meta property="og:type" content="article">
<meta property="og:title" content="Android基础之Activity学习">
<meta property="og:url" content="http://belief1992.com/2015/08/22/Android基础之Activity学习/">
<meta property="og:site_name" content="Daniel_Wen's blog">
<meta property="og:description" content="在安卓应用开发过程中，Activity是我们最常接触的。关于Activity，官方文档介绍的非常详细：Activity基础知识介绍：(http://developer.android.com/guide/components/activities.html)Activity生命周期管理：(http://developer.android.com/training/basics/activity-l">
<meta property="og:image" content="/pictures/activity_lifecycle.jpg">
<meta property="og:image" content="/pictures/activity_saveinstancestate.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android基础之Activity学习">
<meta name="twitter:description" content="在安卓应用开发过程中，Activity是我们最常接触的。关于Activity，官方文档介绍的非常详细：Activity基础知识介绍：(http://developer.android.com/guide/components/activities.html)Activity生命周期管理：(http://developer.android.com/training/basics/activity-l">

  
    <link rel="alternative" href="/atom.xml" title="Daniel_Wen&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.jpg">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/favicon.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Daniel_Wen</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Whatever is worth doing is worth doing well.</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/categories/随笔">随笔</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/HelloWorld1992" title="github">github</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Hexo/" style="font-size: 10.00px;">Hexo</a><a href="/tags/View/" style="font-size: 16.67px;">View</a><a href="/tags/activity/" style="font-size: 13.33px;">activity</a><a href="/tags/android/" style="font-size: 20.00px;">android</a><a href="/tags/心理学/" style="font-size: 13.33px;">心理学</a><a href="/tags/思考与感悟/" style="font-size: 13.33px;">思考与感悟</a><a href="/tags/性能优化/" style="font-size: 10.00px;">性能优化</a><a href="/tags/搭建博客/" style="font-size: 10.00px;">搭建博客</a><a href="/tags/方法论/" style="font-size: 10.00px;">方法论</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">小小程序猿一枚，专注于Android, Java开发。热爱生活，热爱互联网，热血动漫‘脑残粉’。</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Daniel_Wen</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/favicon.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Daniel_Wen</h1>
			</hgroup>
			
			<p class="header-subtitle">Whatever is worth doing is worth doing well.</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/categories/随笔">随笔</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/HelloWorld1992" title="github">github</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-Android基础之Activity学习" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/08/22/Android基础之Activity学习/" class="article-date">
  	<time datetime="2015-08-22T05:52:02.000Z" itemprop="datePublished">8月 22 2015</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android基础之Activity学习
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/activity/">activity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/学习/">学习</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在安卓应用开发过程中，Activity是我们最常接触的。关于Activity，官方文档介绍的非常详细：<br>Activity基础知识介绍：(<a href="http://developer.android.com/guide/components/activities.html" target="_blank" rel="external">http://developer.android.com/guide/components/activities.html</a>)<br>Activity生命周期管理：(<a href="http://developer.android.com/training/basics/activity-lifecycle/index.html" target="_blank" rel="external">http://developer.android.com/training/basics/activity-lifecycle/index.html</a>)<br><a id="more"></a></p>
<h2 id="Activity的生命周期">Activity的生命周期</h2>
<p>Activity的生命周期是我们开发人员必须掌握的，一图胜千言：<br><img src="/pictures/activity_lifecycle.jpg" alt="Activity生命周期"></p>
<p>上图是Activity的生命周期的一个简单描述，我们根据项目需求来重写需要实现的回调方法。了解每一个回调方法的使用情况才能让我们的app表现更好，例如：</p>
<blockquote>
<p>Does not crash if the user receives a phone call or switches to another app while using your app.<br>Does not consume valuable system resources when the user is not actively using it.<br>Does not lose the user’s progress if they leave your app and return to it at a later time.<br>Does not crash or lose the user’s progress when the screen rotates between landscape and portrait orientation.</p>
</blockquote>
<p>在Activity的生命周期中，可以从一个状态过渡到另一个状态，但是，Activity只能静止停留在以下三种状态中的一种：</p>
<blockquote>
<p>Resumed<br>In this state, the activity is in the foreground and the user can interact with it. (Also sometimes referred to as the “running” state.)</p>
<p>Paused<br>In this state, the activity is partially obscured by another activity—the other activity that’s in the foreground is semi-transparent or doesn’t cover the entire screen. The paused activity does not receive user input and cannot execute any code.</p>
<p>Stopped<br>In this state, the activity is completely hidden and not visible to the user; it is considered to be in the background. While stopped, the activity instance and all its state information such as member variables is retained, but it cannot execute any code.</p>
</blockquote>
<h2 id="onPause()和onResume()">onPause()和onResume()</h2>
<p>onPause()和onResume()经常配套使用，当执行onPause()方法，意味着activity还部分可见，但是很多情况下是用户准备离开这个activity，并且随之将调用onStop()，所以在onPause()方法中我们应该做以下事情：</p>
<blockquote>
<p>Stop animations or other ongoing actions that could consume CPU.<br>Commit unsaved changes, but only if users expect such changes to be permanently saved when they leave (such as a draft email).<br>Release system resources, such as broadcast receivers, handles to sensors (like GPS), or any resources that may affect battery life while your activity is paused and the user does not need them.</p>
</blockquote>
<p>但是，我们应该避免在onPause()方法中做很消耗CPU的操作，例如数据库操作，因为这样会减慢可见过渡到下一个activity的过程，应该放在onStop()方法中。在onStop()方法中，我们应该释放掉绝大多数不再需要的资源，因为onStop()执行后，系统可能由于回收内存而直接干掉activity，极端情况下可能直接干掉进程而不执行onDestroy()方法，因此在onStop()方法中来释放资源避免内存泄露。</p>
<h2 id="保存信息">保存信息</h2>
<p>有时候，由于不正常的行为导致activity销毁并重新创建，例如屏幕旋转，这样原先的一些状态信息就会丢失，例如之前用户输入的信息，用户当然不想再重新输入一遍，为了保留这些信息，可以在onSaveInstanceState()方法中使用Bundle来保存数据，然后在onRestoreInstanceState()方法和onCreate()方法中重新获取这些数据。<br><img src="/pictures/activity_saveinstancestate.jpg" alt="Activity生命周期"></p>
<pre><code><span class="keyword">static</span> <span class="keyword">final</span> String STATE_SCORE = <span class="string">"playerScore"</span>;  
<span class="keyword">static</span> <span class="keyword">final</span> String STATE_LEVEL = <span class="string">"playerLevel"</span>;  
...  

<span class="annotation">@Override</span>  
<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span>(Bundle savedInstanceState) {  
    <span class="comment">// Save the user's current game state  </span>
    savedInstanceState.putInt(STATE_SCORE, mCurrentScore);  
    savedInstanceState.putInt(STATE_LEVEL, mCurrentLevel);  

    <span class="comment">// Always call the superclass so it can save the view hierarchy state  </span>
    <span class="keyword">super</span>.onSaveInstanceState(savedInstanceState);  
}  

<span class="annotation">@Override</span>  
<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span>(Bundle savedInstanceState) {  
    <span class="keyword">super</span>.onCreate(savedInstanceState); <span class="comment">// Always call the superclass first  </span>

    <span class="comment">// Check whether we're recreating a previously destroyed instance  </span>
    <span class="keyword">if</span> (savedInstanceState != <span class="keyword">null</span>) {  
        <span class="comment">// Restore value of members from saved state  </span>
        mCurrentScore = savedInstanceState.getInt(STATE_SCORE);  
        mCurrentLevel = savedInstanceState.getInt(STATE_LEVEL);  
    } <span class="keyword">else</span> {  
        <span class="comment">// Probably initialize members with default values for a new instance  </span>
    }  
    ...  
}  

<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceState</span>(Bundle savedInstanceState) {  
    <span class="comment">// Always call the superclass so it can restore the view hierarchy  </span>
    <span class="keyword">super</span>.onRestoreInstanceState(savedInstanceState);  

    <span class="comment">// Restore state members from saved instance  </span>
    mCurrentScore = savedInstanceState.getInt(STATE_SCORE);  
    mCurrentLevel = savedInstanceState.getInt(STATE_LEVEL);  
}  
</code></pre>
      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/08/22/Android基础之Activity启动模式/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Android基础之Activity启动模式
        
      </div>
    </a>
  
  
    <a href="/2015/08/16/《影响力》-读书笔记/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">《影响力》-- 读书笔记</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="Android基础之Activity学习" data-title="Android基础之Activity学习" data-url="http://belief1992.com/2015/08/22/Android基础之Activity学习/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Daniel_Wen
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>

<script src="/js/main.js" type="text/javascript"></script>







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
 
</body>
</html>